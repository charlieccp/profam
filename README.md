
______________________________________________________________________

<div align="center">

# CATH Protein Language Model


</div>

## Description

training a multimodal model on protein documents (TED/AFDB foldseek clusters/openfold MSAs/PFAM...)
[(Docs)](https://docs.google.com/document/d/1UptsPFMFTVyTEu-Ve75NfNpVNrzrWPJlyWvfhi2nsw4/edit)


## Installation

#### Pip

```bash
# clone project
git clone https://github.com/alex-hh/profam.git
cd profam

# [Optional]: create a venv. (Older versions of python also supported currently)
virtualenv -p python3.10 pfenv
source pfenv/bin/activate

# install requirements
pip install -r requirements.txt
```

## Introduction

The repo is built on top of [lightning-hydra-template](https://github.com/ashleve/lightning-hydra-template).

There are two main entrypoints configured by hydra, for running benchmarks and
training runs given configuration provided in config files.

We favour configuring a given benchmarking run via a config in configs/benchmarks
and a given training run via a config in configs/experiments. See the folders
for examples of config files and below for example commands.


### Benchmarking

```bash
python src/run_sampling_evaluation.py benchmark=<BENCHMARK_CFG_NAME>
```

### Training


Run on example data

```bash
python src/train.py logger=null_logger
```

Train model with default configuration

```bash
# train on CPU / GPU / multiple GPUS
python src/train.py trainer=[cpu/gpu/ddp]
```

Train model with an experiment configuration from [configs/experiment/](configs/experiment/)

```bash
python src/train.py experiment=experiment_name.yaml
```

Override configuration parameters using standard

```bash
python src/train.py trainer.max_epochs=20 data.batch_size=64
```

## Development

We're using pre-commit to format code and pytest to run tests.

Pull requests will automatically have pre-commit and pytest run on them
and will only be approved once these checks are all passing

Before submitting a pull request, run the checks locally with:

```bash
pre-commit run --all-files
```

and

```bash
pytest -k 'not example'
```

Pull requests adding complex new features or making any significant changes
or additions should be accompanied with associated tests in the tests/ directory.


## Concepts

### Data loading

TODO

### Benchmarking

TODO


## Project Directory Structure
```
├── .github                   <- Github Actions workflows
│
├── configs                   <- Hydra configs
│   ├── experiment               <- Configs for training runs
|   |── benchmark                <- Configs for benchmarks
|   .
|   .
│   ├── sampling_eval.yaml    <- Main config for sampling evaluation
│   └── train.yaml            <- Main config for training
│
├── data                   <- Project data
│
├── logs                   <- Logs generated by hydra and lightning loggers
│
├── notebooks              <- Jupyter notebooks.
│
├── scripts                <- Shell scripts
│
├── src                    <- Source code
│   ├── data                     <- Data classes, datasets and associated loading and transformation utils
|   |── evaluators               <- Evaluators compute metrics given model outputs on benchmark instances
|   |── pipelines                <- Pipelines define sets of instances constituting a benchmark, and handle collecting and saving metrics from evaluators
|   |── baselines                <- Wrappers for baselines to make them consistent with our benchmarking API
|   |── sequence                 <- Utilities for processing protein sequences
|   |── structure                <- Utilities for processing protein structures
│   ├── models                   <- Model scripts
|   |── tools                    <- Wrappers for external bioinformatics tools e.g. foldseek / hmmer
│   ├── utils                    <- Utility scripts
│   │
│   ├── run_sampling_evaluation.py <- Run sampling benchmarks
│   └── train.py                   <- Run training
│
├── tests                  <- Tests of any kind
│
├── .gitignore                <- List of files ignored by git
├── .pre-commit-config.yaml   <- Configuration of pre-commit hooks for code formatting
├── .project-root             <- File for inferring the position of project root directory
├── environment.yaml          <- File for installing conda environment
├── pyproject.toml            <- Configuration options for testing and linting
├── requirements.txt          <- File for installing python dependencies
├── setup.py                  <- File for installing project as a package
└── README.md
```

<br>
